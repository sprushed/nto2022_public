from random import randint

from Crypto.Util.number import long_to_bytes

from output import c, dh, e, eh, n

d = dh * 256**2 + 1

a = randint(0, n)
r0 = eh * d - 1
g0 = pow(a, r0, n)
mult = pow(a, 2 * eh, n)

for i in range(0, 256**2, 2):
    if g0 == 1:
        break

    g0 = (g0 * mult) % n
    r0 += 2 * eh

d = pow(e, -1, r0)
print(long_to_bytes(pow(c, d, n)))
