from pwn import remote
from os import urandom
from Crypto.Util.Padding import unpad

host, port = "localhost", 17777
r = remote(host, port)

r.recvline()
r.sendline(b"encrypt_flag")

enc_flag = r.recvline().decode().split()[1]
enc_flag = bytes.fromhex(enc_flag)

payload = urandom(16) + enc_flag
r.sendline(b"decrypt_message")
r.sendline(payload.hex().encode())
dec = r.recvline().decode().split()[3]
dec = bytes.fromhex(dec)[16:]
dec = unpad(dec, 16)
print(dec)
